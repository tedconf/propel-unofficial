= What's new in Propel 1.6? =

[[PageOutline]]

Propel 1.6 is a new backwards compatible iteration of the Propel 1.x branch.

== XML/YAML/JSON/CSV Parsing and Dumping ==

ActiveRecord and Collection objects now have the ability to be converted to and from a string, using any of the XML, YAML, JSON, and CSV formats.

The syntax is very intuitive: ActiveRecord and collection objects now offer a `toXML()` and a `fromXML()` method (same for YAML, JSON, and CSV). Here are a few examples:

{{{
#!php
<?php
// dump a collection to YAML
$books = BookQuery::create()
  ->orderByTitle()
  ->joinWith('Author')
  ->find();
echo $books->toYAML();
// Book_1:
//   Id: 123
//   Title: Pride and Prejudice
//   AuthorId: 456
//   Author:
//     Id: 456
//     FirstName: Jane
//     LastName: Austen
// Book_2:
//   Id: 789
//   Title: War and Peace
//   AuthorId: 147
//   Author:
//     Id: 147
//     FirstName: Leo
//     LastName: Tolstoi

// parse an XML string into an object
$bookString = <<<EOF
<?xml version="1.0" encoding="UTF-8"?>
<data>
  <Id>9012</Id>
  <Title><![CDATA[Don Juan]]></Title>
  <ISBN><![CDATA[0140422161]]></ISBN>
  <Price>12.99</Price>
  <PublisherId>1234</PublisherId>
  <AuthorId>5678</AuthorId>
</data>
EOF;
$book = new Book();
$book->fromXML($bookString);
echo $book->getTitle(); // Don Juan
}}}

== Multiple Buildtime Connections ==

Propel 1.5 used the `build.properties` for buildtime connection settings. This had one major drawback: it used to be impossible to deal with several connections at buildtime, let alone several RDBMS.

In Propel 1.6, you can write your buildtime connection settings in a `buildtime-conf.xml` file. The format is the same as the `runtime-conf.xml` file, so a good starting point is to copy the runtime conf, and change the settings for users wit hgreater privileges.

Here is an example buildtime configuration file that defines a MySQL and a SQLite connection:

{{{
#!xml
<?xml version="1.0"?>
<config>
  <propel>
    <datasources default="bookstore">
      <datasource id="bookstore">
        <adapter>mysql</adapter>
        <connection>
          <dsn>mysql:host=localhost;dbname=bookstore</dsn>
          <user>testuser</user>
          <password>password</password>
        </connection>
      </datasource>
      <datasource id="cms">
        <adapter>sqlite</adapter>
        <connection>
          <dsn>sqlite:/opt/databases/mydb.sq3</dsn>
        </connection>
      </datasource>
    </datasources>
  </propel>
</config>
}}}

Now that Propel can deal with database vendors at buildtime more accurately, the generated classes offer more optimizations for the database they rely one. Incidentally, that means that you should rebuild your model if you use different database vendors. Thats includes cases when your developement and production environments use different vendors.